document.addEventListener('DOMContentLoaded', function () {
    // ... ваш остальной код ...

    // --- Анимация для секции "Этапы" (версия с Timeline) ---

    // Находим все элементы этапов
    const stages = gsap.utils.toArray('.stage-fade-up');
    
    // Находим их общий контейнер, который будет триггером
    const stagesContainer = document.querySelector('#stages');

    // 1. Устанавливаем НАЧАЛЬНОЕ состояние для всех этапов с помощью JS.
    // Это запускается сразу, до всяких анимаций, и делает их невидимыми.
    gsap.set(stages, { 
        opacity: 0, 
        y: 80 // Начинают на 80px ниже
    });

    // 2. Создаем временную шкалу (Timeline), привязанную к скроллу
    const tl = gsap.timeline({
        scrollTrigger: {
            trigger: stagesContainer, // Анимация начнется, когда вся секция #stages войдет во вьюпорт
            start: "top 30%",         // Начать, когда 30% секции показалось сверху
            end: "bottom 80%",        // Закончить, когда 80% секции проскроллилось
            scrub: 1.5,               // !!! Связывает анимацию со скроллом, делая ее плавной
            // markers: true,         // Раскомментируйте для отладки
        }
    });

    // 3. Добавляем ОДНУ анимацию на шкалу, которая повлияет на ВСЕ этапы
    tl.to(stages, {
        opacity: 1,      // Анимируем до полной видимости
        y: 0,            // Возвращаем на исходную позицию по Y
        
        // !!! Ключевой параметр: задержка между анимацией каждого элемента.
        // Элементы будут появляться по очереди с интервалом в 0.5 секунды
        // (относительно времени на временной шкале).
        stagger: 0.5 
    });

});